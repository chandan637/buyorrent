FROM node:14.14.0-alpine3.12

WORKDIR /app

RUN mkdir -p ~/ui

RUN mkdir -p ~/api

COPY ui/package*.json /app/ui/

RUN cd /app/ui && npm install && cd ..

COPY api/package*.json /app/api/

RUN cd /app/ui && npm install && cd ..

RUN cd /app/ui && npm run build && cd ..

COPY . .

RUN ls -la .

EXPOSE 3333

RUN cd /app/api

CMD ["npm", "start"]